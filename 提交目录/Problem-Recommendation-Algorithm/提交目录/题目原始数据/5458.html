<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="ACM NOIP 信息学竞赛 测试数据 下载 大全">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>TK题库</title>  
    
<!-- 新 Bootstrap 核心 CSS 文件 -->
<link rel="stylesheet" href="http://cdn.hustoj.com/template/bs3/bootstrap.min.css">

<!-- 可选的Bootstrap主题文件（一般不用引入） -->
<link rel="stylesheet" href="http://cdn.hustoj.com/template/bs3/bootstrap-theme.min.css">
<link rel="stylesheet" href="http://cdn.hustoj.com/template/bs3/white.css">
<link rel="stylesheet" href="http://cdn.hustoj.com/template/bs3/katex.min.css">
<link rel="stylesheet" href="http://cdn.hustoj.com/template/bs3/mathjax.css">
<link rel="stylesheet" href="http://cdn.hustoj.com/template/bs3/semantic.min.css">
	    


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="container">
          <!-- Static navbar -->
      <nav class="navbar navbar-default" role="navigation" >
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="./">TK题库</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
	      <!--              <li ><a href="bbs.php">Web Board</a></li>-->
              <li ><a href="faqs.php"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> F.A.Qs</a></li>
              <li class='btn-primary' ><a style='color:white' href="problemset.php"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> ProblemSet</a></li>
              <li class='btn-success'><a  style='color:white'  href="problemset.php?search=free"><span class="glyphicon glyphicon-gift" aria-hidden="true"></span> 免费专区</a></li>
              <li class='btn-danger'><a  style='color:white' href="problemset.php?hot"><span class="glyphicon glyphicon-fire" aria-hidden="true"></span> 热门下载</a></li>
              <li class='btn-warning'><a  style='color:white' href="category.php"><span class="glyphicon glyphicon-th" aria-hidden="true"></span> Source/Category</a></li>
              <li class='btn-info'><a  style='color:white' href="status.php"><span class="glyphicon glyphicon-play-circle" aria-hidden="true"></span> Status</a></li>
 <!--             <li ><a href="ranklist.php">Ranklist</a></li>
              <li ><a href="recent-contest.php">Recent</a></li>
              <li ><a href="contest.php">Contest</a></li>
	-->
		<li><a > 题目数据全能下，右上角注册充值，支持微信! </a></li>
            </ul>
	    <ul class="nav navbar-nav navbar-right">
	    <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span id="profile">Login</span><span class="caret"></span></a>
            <ul class="dropdown-menu" role="menu">
<script src="template/tk/profile.php?1944079274" ></script>
              <!--<li><a href="../navbar-fixed-top/">Fixed top</a></li>-->
	    </ul>
	    </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container-fluid -->
      </nav>


	    
      <!-- Main component for a primary marketing message or call to action -->
      <div class="jumbotron">
	
<title>Problem 5458 --PQ序列-【2014暑期训练】T2Day1T2</title><center><h2>5458: PQ序列-【2014暑期训练】T2Day1T2</h2><span class=green>Time Limit: </span>1 Sec&nbsp;&nbsp;<span class=green>Memory Limit: </span>256 MB<br><span class=green>Submit: </span>60&nbsp;&nbsp;<span class=green>Solved: </span>22<br>[<a href='submitpage.php?id=5458'>Submit</a>][<a href='problemstatus.php?id=5458'>Status</a>][<a href='bbs.php?pid=5458'>Web Board</a>][Creator:<span id='creator'></span>][<a href='pay.php?pid=5458'>下载FPS1元</a>][<a onclick='$(this).load("cart.php?add=5458");'>添加到购物车</a>][<a href='pay.php?fmt=zipdata&pid=5458'>下载测试数据1元</a>][776kb]</center><!--StartMarkForVirtualJudge--><h2>Description</h2><div class=content><p class="MsoNormal" align="center" style="text-align:center;">
	<b><span style="font-size:18px;">PQ</span></b><b><span style="font-size:18px;">序列</span></b><b></b> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">【问题描述】 </span><span></span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">&nbsp; 有两个长度分别为P+1和q+1的序列A和序列B，每个序列中的各个元素互不相同，且都是1到n^2之间的整数。两个序列的第一个元素均为1。求A和B的最长公共子序列的长度。</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">【文件输入】 </span><span></span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">&nbsp; 输入文件pq.in。</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">第一行为3个整数，n，p,q(2&lt;=n&lt;=250,1&lt;=p,q&lt;=n^2),第二行包含序列A，其中第一个数为1，且元素两两不同，且都是1到n^2之间的整数，第三行包含序列B，格式同序列A。</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">【文件输出】</span> 
</p>
<p class="MsoNormal" style="text-indent:6.0pt;">
	<span style="font-size:18px;">输出文件pq.out。 &nbsp;</span><span></span> 
</p>
<p class="MsoNormal" style="text-indent:6.0pt;">
	<span style="font-size:18px;">输出序列A和序列B的最长公共子序列的长度。</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">【输入样例】 </span><span></span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">10 5 5</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">1 15 20 30 25 19</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">1 20 25 30 18 50</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">【输出样例】</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">3</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">【数据规模】</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">30%的数据 n&lt;=10</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">70%的数据n&lt;=50</span> 
</p>
<p class="MsoNormal">
	<span style="font-size:18px;">100%的数据n&lt;=250</span> 
</p></div><h2>Input</h2><div class=content></div><h2>Output</h2><div class=content></div><h2>HINT</h2>
<div class=content><p><p class="MsoNormal"><br />
	<b>（白书</b><b>p66</b><b>王子和公子）</b><b></b><br />
</p><br />
<p class="MsoNormal"><br />
	本题是LCS（最长公共子序列）问题，但是因为p和q可以高达250^2=62500.O(pq)的算法显然太慢。注意到A序列中所有元素均不同，因此可以把A中元素从小编号为1~p+1，例如，A={1，7，5，4，8，3，9}，B={1，4，3，5，6，2，8，9}，因此把A重新编号为{1，2，3，4，5，6，7}，则B就是{1，4，6，3，0，0，5，7}，其中0表示A中没有出现过（事实上，可以直接删除这些元素，因为他们肯定不会出现在LCS中）。这样，新的A和B的LCS实际上就是新的B的LIS（最长不下降序列）。由于LIS可以在O(nlogn)时间内解决，因此本题也可以在O(nlogn)时间内得到解决。<br />
</p><br />
<p class="MsoNormal"><br />
	&nbsp;<br />
</p><br />
<p class="MsoNormal"><br />
	<b>O(nlogn)</b><b>求</b><b>LIS</b><br />
</p><br />
<p style="background:white;"><br />
	这题目是经典的DP题目，也可叫作LIS（Longest Increasing Subsequence）最长上升子序列 或者 最长不下降子序列。很基础的题目，有两种算法，复杂度分别为O(n*logn)和O(n^2) 。<br /><br />
<br /><br />
O(n^2)算法分析如下：<span class="apple-converted-space">&nbsp;</span><br /><br />
<br /><br />
（a[1]...a[n] 存的都是输入的数）<span class="apple-converted-space">&nbsp;</span><br /><br />
1、对于a[n]来说，由于它是最后一个数，所以当从a[n]开始查找时，只存在长度为1的不下降子序列；<span class="apple-converted-space">&nbsp;</span><br />
</p><br />
<p style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	2、若从a[n-1]开始查找，则存在下面的两种可能性：<span class="apple-converted-space">&nbsp;</span><br /><br />
&nbsp;&nbsp; （1）若a[n-1] &lt; a[n] 则存在长度为2的不下降子序列 a[n-1],a[n];<br /><br />
&nbsp;&nbsp; （2）若a[n-1] &gt; a[n] 则存在长度为1的不下降子序列 a[n-1]或者a[n]。<span class="apple-converted-space">&nbsp;</span><br />
</p><br />
<p style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	3、一般若从a[t]开始，此时最长不下降子序列应该是按下列方法求出的：<span class="apple-converted-space">&nbsp;</span><br /><br />
&nbsp;&nbsp;&nbsp; 在a[t+1],a[t+2],...a[n]中，找出一个比a[t]大的且最长的不下降子序列，作为它的后继。<span class="apple-converted-space">&nbsp;</span><br />
</p><br />
<p style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	4、为算法上的需要，定义一个数组：<br /><br />
&nbsp;&nbsp;&nbsp; int d[n][3];<span class="apple-converted-space">&nbsp;</span><br /><br />
&nbsp;&nbsp;&nbsp; d[t][0]表示a[t];<span class="apple-converted-space">&nbsp;</span><br /><br />
&nbsp;&nbsp;&nbsp; d[t][1]表示从i位置到达n的最长不下降子序列的长度;<br /><br />
&nbsp;&nbsp;&nbsp; d[t][2]表示从i位置开始最长不下降子序列的下一个位置。<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	实现代码如下：<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;<br />
</p><br />
<p class="MsoNormal" style="background:#F8F8F8;"><br />
	<b>[cpp]</b><span class="apple-converted-space">&nbsp;</span><a href="http://blog.csdn.net/dangwenliang/article/details/5728363">view plain</a><a href="http://blog.csdn.net/dangwenliang/article/details/5728363">copy</a><br />
</p><br />
<div style="border:none;padding:0cm 0cm 0cm 0cm;background:white;margin-left:18.0pt;"><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		1.&nbsp;&nbsp;&nbsp;&nbsp; <span class="preprocessor">#include&nbsp;&lt;iostream&gt;</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		2.&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword"><b>using</b></span>&nbsp;<span class="keyword"><b>namespace</b></span>&nbsp;std;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		3.&nbsp;&nbsp;&nbsp;&nbsp; <span class="datatypes"><b>int</b></span>&nbsp;main(<span class="keyword"><b>void</b></span>)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		4.&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		5.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes"><b>int</b></span>&nbsp;i,j,n,a[100],b[100],max;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		6.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>while</b></span>(cin&gt;&gt;n)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		7.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		8.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(i=0;i&lt;n;i++)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		9.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin&gt;&gt;a[i];&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		10.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[0]=1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//</span><span class="comment">初始化，以</span><span class="comment">a[0]</span><span class="comment">结尾的最长递增子序列长度为</span><span class="comment">1</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		11.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(i=1;i&lt;n;i++)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		12.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		13.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i]=1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//b[i]</span><span class="comment">最小值为</span><span class="comment">1</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		14.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(j=0;j&lt;i;j++)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		15.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>if</b></span>(a[i]&gt;a[j]&amp;&amp;b[j]+1&gt;b[i])&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		16.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i]=b[j]+1;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		17.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		18.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(max=i=0;i&lt;n;i++)<span class="comment">//</span><span class="comment">求出整个数列的最长递增子序列的长度</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		19.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>if</b></span>(b[i]&gt;max)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		20.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max=b[i];&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		21.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;max&lt;&lt;endl;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		22.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		23.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>return</b></span>&nbsp;0;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		24.&nbsp; }&nbsp;&nbsp;<br />
	</p><br />
</div><br />
<p class="MsoNormal" style="margin-left:-17.95pt;background:white;"><br />
	<span><br /><br />
&nbsp;&nbsp;&nbsp; </span>显然，这种方法的时间复杂度仍为<span>o(n^2);</span><br />
</p><br />
<p style="background:white;"><br />
	最长不下降子序列的O(nlogn)算法分析如下:<span class="apple-converted-space">&nbsp;</span><br /><br />
<br /><br />
设 A[t]表示序列中的第t个数，F[t]表示从1到t这一段中以t结尾的最长上升子序列的长度，初始时设F [t] = 0(t = 1, 2, ...,<br />
len(A))。则有动态规划方程：F[t] = max{1, F[j] + 1} (j =<br />
1, 2, ..., t - 1, 且A[j] &lt; A[t])。<span class="apple-converted-space">&nbsp;</span><br /><br />
<br /><br />
现在，我们仔细考虑计算F[t]时的情况。假设有两个元素A[x]和A[y]，满足<span class="apple-converted-space">&nbsp;</span><br /><br />
(1)x &lt; y &lt; t<span class="apple-converted-space">&nbsp;</span><br /><br />
(2)A[x] &lt; A[y] &lt; A[t]<span class="apple-converted-space">&nbsp;</span><br /><br />
(3)F[x] = F[y]<span class="apple-converted-space">&nbsp;</span><br />
</p><br />
<p style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	此时，选择F[x]和选择F[y]都可以得到同样的F[t]值，那么，在最长上升子序列的这个位置中，应该选择A[x]还是应该选择A[y]呢？<span class="apple-converted-space">&nbsp;</span><br />
</p><br />
<p style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	很明显，选择A[x]比选择A[y]要好。因为由于条件(2)，在A[x+1] ... A[t-1]这一段中，如果存在A[z]，A[x] &lt; A[z] &lt; a[y]，则与选择A[y]相比，将会得到更长的上升子序列。<span class="apple-converted-space">&nbsp;</span><br /><br />
再根据条件(3)，我们会得到一个启示：根据F[]的值进行分类。对于F[]的每一个取值k，我们只需要保留满足F[t] = k的所有A[t]中的最小值。设D[k]记录这个值，即D[k] = min{A[t]} (F[t] = k)。<span class="apple-converted-space">&nbsp;</span><br /><br />
<br /><br />
注意到D[]的两个特点：<span class="apple-converted-space">&nbsp;</span><br /><br />
(1)　D[k]的值是在整个计算过程中是单调不下降的。<span class="apple-converted-space">&nbsp;</span><br /><br />
(2)　D[]的值是有序的，即D[1] &lt; D[2] &lt; D[3] &lt;<br />
... &lt; D[n]。<span class="apple-converted-space">&nbsp;</span><br /><br />
<br /><br />
利 用D[]，我们可以得到另外一种计算最长上升子序列长度的方法。设当前已经求出的最长上升子序列长度为len。先判断A[t]与D[len]。若A [t] &gt; D[len]，则将A[t]接在D[len]后将得到一个更长的上升子序列，len = len + 1， D[len] = A [t]；否则，在D[1]..D[len]中，找到最大的j，满足D[j] &lt; A[t]。令k = j + 1，则有A [t] &lt;= D[k]，将A[t]接在D[j]后将得到一个更长的上升子序列，更新D[k] = A[t]。最后，len即为所要求的最长上 升子序列的长度。<span class="apple-converted-space">&nbsp;</span><br /><br />
<br /><br />
在 上述算法中，若使用朴素的顺序查找在D[1]..D[len]查找，由于共有O(n)个元素需要计算，每次计算时的复杂度是O(n)，则整个算法的 时间复杂度为O(n^2)，与原来的算法相比没有任何进步。但是由于D[]的特点(2)，我们在D[]中查找时，可以使用二分查找高效地完成，则整个算法 的时间复杂度下降为O(nlogn)，有了非常显著的提高。需要注意的是，D[]在算法结束后记录的并不是一个符合题意的最长上升子序列！<br /><br />
<br /><br />
&nbsp;&nbsp;<br />
</p><br />
<p class="MsoNormal" style="background:#F8F8F8;"><br />
	<b>[cpp]</b><span class="apple-converted-space">&nbsp;</span><a href="http://blog.csdn.net/dangwenliang/article/details/5728363">view plain</a><a href="http://blog.csdn.net/dangwenliang/article/details/5728363">copy</a><br />
</p><br />
<div style="border:none;padding:0cm 0cm 0cm 0cm;background:white;margin-left:18.0pt;"><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		1.&nbsp;&nbsp;&nbsp;&nbsp; <span class="preprocessor">#include&nbsp;&lt;iostream&gt;</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		2.&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword"><b>using</b></span>&nbsp;<span class="keyword"><b>namespace</b></span>&nbsp;std;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		3.&nbsp;&nbsp;&nbsp;&nbsp; <span class="datatypes"><b>int</b></span>&nbsp;find(<span class="datatypes"><b>int</b></span>&nbsp;*a,<span class="datatypes"><b>int</b></span>&nbsp;len,<span class="datatypes"><b>int</b></span>&nbsp;n)<span class="comment">//</span><span class="comment">若返回值为</span><span class="comment">x,</span><span class="comment">则</span><span class="comment">a[x]&gt;=n&gt;a[x-1]</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		4.&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		5.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes"><b>int</b></span>&nbsp;left=0,right=len,mid=(left+right)/2;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		6.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>while</b></span>(left&lt;=right)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		7.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		8.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>if</b></span>(n&gt;a[mid])&nbsp;left=mid+1;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		9.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>else</b></span>&nbsp;<span class="keyword"><b>if</b></span>(n&lt;a[mid])&nbsp;right=mid-1;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		10.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>else</b></span>&nbsp;<span class="keyword"><b>return</b></span>&nbsp;mid;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		11.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mid=(left+right)/2;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		12.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		13.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>return</b></span>&nbsp;left;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		14.&nbsp; }&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		15.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		16.&nbsp; <span class="keyword"><b>void</b></span>&nbsp;fill(<span class="datatypes"><b>int</b></span>&nbsp;*a,<span class="datatypes"><b>int</b></span>&nbsp;n)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		17.&nbsp; {&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		18.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(<span class="datatypes"><b>int</b></span>&nbsp;i=0;i&lt;=n;i++)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		19.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[i]=1000;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		20.&nbsp; }&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		21.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		22.&nbsp; <span class="datatypes"><b>int</b></span>&nbsp;main(<span class="keyword"><b>void</b></span>)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		23.&nbsp; {&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		24.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes"><b>int</b></span>&nbsp;max,i,j,n,a[100],b[100],c[100];&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		25.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>while</b></span>(cin&gt;&gt;n)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		26.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		27.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill(c,n+1);&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		28.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(i=0;i&lt;n;i++)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		29.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin&gt;&gt;a[i];&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		30.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c[0]=-1;<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;…………………………………1</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		31.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c[1]=a[0];<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;…………………………2</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		32.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[0]=1;<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;…………………………………3</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		33.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(i=1;i&lt;n;i++)<span class="comment">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;………………4</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		34.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		35.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j=find(c,n+1,a[i]);<span class="comment">//&nbsp;&nbsp;…………………5</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		36.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c[j]=a[i];<span class="comment">//&nbsp;………………………………6</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		37.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i]=j;<span class="comment">//……………………………………7</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		38.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		39.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(max=i=0;i&lt;n;i++)<span class="comment">//&nbsp;………………………8</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		40.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>if</b></span>(b[i]&gt;max)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		41.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max=b[i];&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		42.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;max&lt;&lt;endl;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		43.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		44.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>return</b></span>&nbsp;0;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		45.&nbsp; }&nbsp;&nbsp;&nbsp;<br />
	</p><br />
</div><br />
<p class="MsoNormal" style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp; 对于这段程序，我们可以用算法导论上的loop invariants来帮助理解.<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;loop invariant<span class="apple-converted-space">&nbsp;</span>: 1、每次循环结束后c都是单调递增的。(这一性质决定了可以用二分查找）<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
2、每次循环后，c[i]总是保存长度为i的递增子序列的最末的元素，若长度为i的递增子序<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
列有多个，刚保存末尾元素最小的那个.（这一性质决定是第3条性质成立的前提）<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
3、每次循环完后，b[i]总是保存以a[i]结尾的最长递增子序列。<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;initialization:<span class="apple-converted-space">&nbsp;</span>&nbsp;&nbsp;&nbsp; 1、进入循环之前，c[0]=-1,c[1]=a[0],c的其他元素均为1000,c是单调递增的;<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
2、进入循环之前，c[1]=a[0],保存了长度为1时的递增序列的最末的元素，且此时长度为1<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
的递增了序列只有一个，c[1]也是最小的;<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
3、进入循环之前，b[0]=1，此时以a[0]结尾的最长递增子序列的长度为1.<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;maintenance:<span class="apple-converted-space">&nbsp;</span>&nbsp;&nbsp; 1、若在第n次循环之前c是单调递增的，则第n次循环时，c的值只在第6行发生变化，而由<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
c进入循环前单调递增及find函数的性质可知（见find的注释),<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
此时c[j+1]&gt;c[j]&gt;=a[i]&gt;c[j-1],所以把c[j]的值更新为a[i]后，c[j+1]&gt;c[j]&gt; c[j-1]的性质仍然成<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
立，即c仍然是单调递增的；<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
2、循环中，c的值只在第6行发生变化，由c[j]&gt;=a[i]可知，c[j]更新为a[i]后，c[j]的值只会变<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
小不会变大，因为进入循环前c[j]的值是最小的，则循环中把c[j]更新为更小的a[i]，当<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
然此时c[j]的值仍是最小的;<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3、循环中，b[i]的值在第7行发生了变化，因为有loop invariant的性质2，find函数返回值<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
为j有：c[j-1]&lt;a[i]&lt;=c[j],这说明c[j-1]是小于a[i]的，且以c[j-1]结尾的递增子序列有最大的<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
长度，即为j-1,把a[i]接在c[j-1]后可得到以a[i]结尾的最长递增子序列，长度为(j-1)+1=j;<br /><br />
&nbsp;&nbsp;&nbsp;&nbsp;termination:<span class="apple-converted-space">&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
循环完后，i=n-1,b[0],b[1],...,b[n-1]的值均已求出，即以a[0],a[1],...,a[n-1]结尾的最长递<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
增子序列的长度均已求出，再通过第8行的循环，即求出了整个数组的最长递增子序列。<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	&nbsp;<br />
</p><br />
<p style="background:white;"><br />
	仔细分析上面的代码可以发现，每次循环结束后，假设已经求出c[1],c[2],c[3],...,c[len]的值，则此时最长递增子序列的长度为 len,因此可以把上面的代码更加简化，即可以不需要数组b来辅助存储，第8行的循环也可以省略。<br /><br />
&nbsp;&nbsp;&nbsp;<br />
</p><br />
<p class="MsoNormal" style="background:#F8F8F8;"><br />
	<b>[cpp]</b><span class="apple-converted-space">&nbsp;</span><a href="http://blog.csdn.net/dangwenliang/article/details/5728363">view plain</a><a href="http://blog.csdn.net/dangwenliang/article/details/5728363">copy</a><br />
</p><br />
<div style="border:none;padding:0cm 0cm 0cm 0cm;background:white;margin-left:18.0pt;"><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		1.&nbsp;&nbsp;&nbsp;&nbsp; <span class="preprocessor">#include&nbsp;&lt;iostream&gt;</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		2.&nbsp;&nbsp;&nbsp;&nbsp; <span class="keyword"><b>using</b></span>&nbsp;<span class="keyword"><b>namespace</b></span>&nbsp;std;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		3.&nbsp;&nbsp;&nbsp;&nbsp; <span class="datatypes"><b>int</b></span>&nbsp;find(<span class="datatypes"><b>int</b></span>&nbsp;*a,<span class="datatypes"><b>int</b></span>&nbsp;len,<span class="datatypes"><b>int</b></span>&nbsp;n)<span class="comment">//</span><span class="comment">修改后的二分查找，若返回值为</span><span class="comment">x</span><span class="comment">，则</span><span class="comment">a[x]&gt;=n</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		4.&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		5.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes"><b>int</b></span>&nbsp;left=0,right=len,mid=(left+right)/2;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		6.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>while</b></span>(left&lt;=right)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		7.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		8.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>if</b></span>(n&gt;a[mid])&nbsp;left=mid+1;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		9.&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>else</b></span>&nbsp;<span class="keyword"><b>if</b></span>(n&lt;a[mid])&nbsp;right=mid-1;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		10.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>else</b></span>&nbsp;<span class="keyword"><b>return</b></span>&nbsp;mid;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		11.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mid=(left+right)/2;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		12.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		13.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>return</b></span>&nbsp;left;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		14.&nbsp; }&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		15.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		16.&nbsp; <span class="datatypes"><b>int</b></span>&nbsp;main(<span class="keyword"><b>void</b></span>)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		17.&nbsp; {&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		18.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="datatypes"><b>int</b></span>&nbsp;n,a[100],c[100],i,j,len;<span class="comment">//</span><span class="comment">新开一变量</span><span class="comment">len,</span><span class="comment">用来储存每次循环结束后</span><span class="comment">c</span><span class="comment">中已经求出值的元素的最大下标</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		19.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>while</b></span>(cin&gt;&gt;n)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		20.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		21.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(i=0;i&lt;n;i++)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		22.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cin&gt;&gt;a[i];&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		23.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[0]=1;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		24.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c[0]=-1;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		25.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c[1]=a[0];&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		26.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len=1;<span class="comment">//</span><span class="comment">此时只有</span><span class="comment">c[1]</span><span class="comment">求出来，最长递增子序列的长度为</span><span class="comment">1.</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		27.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>for</b></span>(i=1;i&lt;n;i++)&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		28.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		29.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j=find(c,len,a[i]);&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		30.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c[j]=a[i];&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		31.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>if</b></span>(j&gt;len)<span class="comment">//</span><span class="comment">要更新</span><span class="comment">len,</span><span class="comment">另外补充一点：由二分查找可知</span><span class="comment">j</span><span class="comment">只可能比</span><span class="comment">len</span><span class="comment">大</span><span class="comment">1</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		32.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len=j;<span class="comment">//</span><span class="comment">更新</span><span class="comment">len</span>&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		33.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		34.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;len&lt;&lt;endl;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		35.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;background:#F8F8F8;"><br />
		36.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword"><b>return</b></span>&nbsp;0;&nbsp;&nbsp;<br />
	</p><br />
	<p class="MsoNormal" align="left" style="margin-left:18pt;text-indent:-18pt;"><br />
		37.&nbsp; }&nbsp;&nbsp;<br />
	</p><br />
</div><br />
<p class="MsoNormal"><br />
	<b>&nbsp;</b><br />
</p></p></div><h2>Source</h2><div class=content><p><a href='problemset.php?search=%E6%A8%A1%E6%8B%9F%E8%B5%9B-2014%E6%9A%91%E6%9C%9F%E8%AE%AD%E7%BB%83'>模拟赛-2014暑期训练</a>&nbsp;</p></div><center><!--EndMarkForVirtualJudge-->[<a href='submitpage.php?id=5458'>Submit</a>][<a href='problemstatus.php?id=5458'>Status</a>]</center>      </div>

    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
<script src="http://cdn.hustoj.com/template/bs3/jquery.min.js"></script>

<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="http://cdn.hustoj.com/template/bs3/bootstrap.min.js"></script>

<!--<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
-->
<script>
$(document).ready(function(){
  var msg="<div style='margin-top:10px'  direction='up'   id=broadcast scrollamount=1 scrolldelay=50 onMouseOver='this.stop()'"+
      " onMouseOut='this.start()' class=toprow>"+"<p style=\"text-align:center;\">\r\n\t<span style=\"color:#24292E;font-family:-apple-system&#44; bl<x>inkMacSystemFont&#44; &quot;font-size:16px;background-color:#FFFFFF;\">\u5e86\u795dhustoj\u5728\u9996\u5c4a\u6df1\u5ea6\u8f6f\u4ef6\u5f00\u53d1\u5927\u8d5b\u4e2d\u83b7\u5f97\u4e09\u7b49\u5956\uff0c\u5145\u503c100\u900120\u3002<\/span>\r\n<br \/>\r\n<p style=\"text-align:center;\">\r\n\t\u672c\u7cfb\u7edf\u652f\u6301\u4e24\u79cd\u683c\u5f0f\u6570\u636e\u4e0b\u8f7d\uff0cfps\/xm<x>l\u683c\u5f0f\u542b\u9898\u9762\u56fe\u7247\u6570\u636e\u6807\u7a0b\u652f\u6301hustoj\u7cfb\u7edf\u76f4\u63a5\u5bfc\u5165\uff0czip\u683c\u5f0f\u4ec5\u542b\u6570\u636e\u4e0d\u542b\u9898\u9762\u3002\r\n<br \/>\r\n<p style=\"text-align:center;\">\r\n\t\u91cd\u590d\u4e0b\u8f7d\u4e0d\u91cd\u590d\u8ba1\u8d39\u3002\r\n<br \/>\r\n<p style=\"text-align:center;\">\r\n\t\u5982\u9047\u5145\u503c\u4e0d\u80fd\u5230\u8d26&#44;\u8bf7\u8054\u7cfbQQ:10982766\u63d0\u4f9b\u7528\u6237\u540d\u548c\u652f\u4ed8\u5355\u53f7\u8fdb\u884c\u6838\u5bf9\r\n<br \/>\r\n<p style=\"text-align:center;\">\r\n\t\u7ecf\u8d39\u4e0d\u8db3\u7684\u8001\u5e08\u540c\u5b66\u8bf7\u5148\u770b <br \/>\r\n<span class=\"btn-success\"> <a href=\"problemset.php?search=free\"><span> \u514d\u8d39\u4e13\u533a<\/span><\/a> <\/span>\r\n<br \/>"+"</div>";
  $(".jumbotron").prepend(msg);
  $("form").append("<div id='csrf' />");
  $("#csrf").load("csrf.php");
  $("body").append("<div id=footer class=center >GPLv2 licensed by <a href='https://github.com/zhblue/hustoj' >HUSTOJ</a> "+(new Date()).getFullYear()+" </div>");
  $("body").append("<div class=center > <img src='http://hustoj.com/wx.jpg' width='96px'><br> 欢迎关注微信公众号onlinejudge<br><img src=\"http://tk.hustoj.com/upload/image/20180621/20180621190059_62537.png\" width=\"200\" height=\"301\"  alt='支付宝扫一扫领红包'/></div>");
});
  console.log("If you want to change the appearance of the web pages, make a copy of bs3 under template directory.\nRename it to whatever you like, and change the $OJ_TEMPLATE value in db_info.inc.php\nAfter that modify files under your own directory .\n");


</script>

	
<script>
function phpfm(pid){
        //alert(pid);
        $.post("admin/phpfm.php",{'frame':3,'pid':pid,'pass':''},function(data,status){
                if(status=="success"){
                        document.location.href="admin/phpfm.php?frame=3&pid="+pid;
                }
        });
}
$(document).ready(function(){
	$("#creator").load("problem-ajax.php?pid=5458");
});
</script>	  
  </body>
</html>
<!--not cached-->
